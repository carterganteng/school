
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carter School - Day 1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #1a1a2e;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-container {
            width: 100%;
            max-width: 1200px;
            height: 100%;
            max-height: 800px;
            position: relative;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(255, 105, 180, 0.3);
            overflow: hidden;
        }

        /* Opening Screen Styles */
        #opening-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.7)), url('opening.png');
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 100;
            text-align: center;
            padding: 40px;
        }

        #game-title {
            font-size: 4rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 105, 180, 0.7);
            color: #ff69b4;
            font-weight: bold;
            letter-spacing: 3px;
        }

        #game-subtitle {
            font-size: 1.5rem;
            margin-bottom: 40px;
            color: #f8f8f8;
            max-width: 600px;
            line-height: 1.6;
        }

        #play-btn {
            background: linear-gradient(45deg, #ff69b4, #ff85a2);
            color: white;
            border: none;
            padding: 15px 50px;
            border-radius: 50px;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4);
            font-weight: bold;
            letter-spacing: 1px;
        }

        #play-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.6);
        }

        /* Game Screen Styles */
        #game-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
        }

        #background {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            transition: background-image 1s ease;
            z-index: 1;
        }

        #characters {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 2;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            pointer-events: none;
        }

        .character {
            position: absolute;
            bottom: 0;
            transition: opacity 0.5s ease, transform 0.5s ease;
            max-height: 80%;
            filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
        }

        .character-left {
            left: 5%;
        }

        .character-right {
            right: 5%;
        }

        .character-center {
            left: 50%;
            transform: translateX(-50%);
        }

        #dialogue-box {
            position: absolute;
            bottom: 0;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            border-top: 3px solid #ff85a2;
            padding: 20px;
            z-index: 3;
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.1);
        }

        #character-name {
            font-weight: bold;
            color: #ff85a2;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        #dialogue-text {
            font-size: 1.1rem;
            line-height: 1.5;
            margin-bottom: 20px;
            min-height: 60px;
        }

        #choices {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .choice-btn {
            background-color: #ff85a2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 1rem;
        }

        .choice-btn:hover {
            background-color: #ff6b93;
        }

        #menu {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 5;
            display: flex;
            gap: 10px;
        }

        .menu-btn {
            background-color: rgba(255, 255, 255, 0.8);
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        #save-indicator {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            z-index: 5;
            display: none;
        }

        #next-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background-color: #ff85a2;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 4;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        #next-btn:hover {
            background-color: #ff6b93;
        }

        #day-indicator {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 20px;
            border-radius: 30px;
            z-index: 5;
            font-size: 1rem;
        }

        .debug-info {
            position: absolute;
            top: 60px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Opening Screen -->
        <div id="opening-screen">
            <h1 id="game-title">CARTER SCHOOL</h1>
            <p id="game-subtitle">A magical high school romance where your choices shape your destiny. Meet intriguing characters, forge friendships, and discover secrets in this enchanting academy.</p>
            <button id="play-btn">START DAY 1</button>
        </div>

        <!-- Game Screen -->
        <div id="game-screen">
            <div id="background"></div>
            
            <div id="characters">
                <!-- Characters will be dynamically added here -->
            </div>
            
            <div id="dialogue-box">
                <div id="character-name"></div>
                <div id="dialogue-text"></div>
                <div id="choices"></div>
            </div>
            
            <div id="next-btn">â–¶</div>
            
            <div id="menu">
                <button class="menu-btn" id="save-btn">Save</button>
                <button class="menu-btn" id="load-btn">Load</button>
            </div>
            
            <div id="save-indicator">Game Saved!</div>
            <div id="day-indicator">DAY 1</div>
            <div class="debug-info" id="debug-info"></div>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            currentScene: 0,
            currentDialogue: 0,
            relationshipPoints: {
                Marf: 0,
                Lula: 0,
                Jude: 0,
                JM: 0
            },
            currentBackground: '',
            currentCharacters: [],
            savedGame: null
        };

        // Background images - using your actual files
        const backgrounds = {
            classroom: 'bg/classroom.png',
            cafeteria: 'bg/cafeteria.png',
            rooftop: 'bg/rooftop.png',
            gate: 'bg/school_gate.png',
            library: 'bg/library.png'
        };

        // Character sprites - using your actual sprite files
        const characterSprites = {
            Carter: {
                neutral: 'sprite/carter_neutral.png',
                happy: 'sprite/carter_happy.png',
                sad: 'sprite/carter_sad.png',
                blush: 'sprite/carter_blush.png',
                angry: 'sprite/carter_angry.png',
                surprised: 'sprite/carter_surprised.png'
            },
            Marf: {
                neutral: 'sprite/marf_neutral.png',
                happy: 'sprite/marf_happy.png',
                sad: 'sprite/marf_sad.png',
                blush: 'sprite/marf_blush.png',
                angry: 'sprite/marf_angry.png',
                surprised: 'sprite/marf_surprised.png'
            },
            Lula: {
                neutral: 'sprite/lula_neutral.png',
                happy: 'sprite/lula_happy.png',
                sad: 'sprite/lula_sad.png',
                blush: 'sprite/lula_blush.png',
                angry: 'sprite/lula_angry.png',
                surprised: 'sprite/lula_surprised.png'
            },
            Jude: {
                neutral: 'sprite/jude_neutral.png',
                happy: 'sprite/jude_happy.png',
                sad: 'sprite/jude_sad.png',
                blush: 'sprite/jude_blush.png',
                angry: 'sprite/jude_angry.png',
                surprised: 'sprite/jude_surprised.png'
            },
            JM: {
                neutral: 'sprite/jm_neutral.png',
                happy: 'sprite/jm_happy.png',
                sad: 'sprite/jm_sad.png',
                blush: 'sprite/jm_blush.png',
                angry: 'sprite/jm_angry.png',
                surprised: 'sprite/jm_surprised.png'
            }
        };

        // Story script for Day 1
        const storyScript = [
            // Scene 0: Introduction - School Gate
            {
                background: backgrounds.gate,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'center' }
                ],
                dialogue: [
                    {
                        character: 'Carter',
                        text: 'Here I am... Carter School. My first day at this prestigious academy. Mom was so excited when I got accepted, but honestly, I\'m pretty nervous.'
                    },
                    {
                        character: 'Carter',
                        text: 'They say this school has a special program for students with... unique talents. I wonder what they mean by that.'
                    },
                    {
                        character: 'Carter',
                        text: 'Well, no point standing here all day. Time to face whatever awaits inside.'
                    }
                ]
            },
            
            // Scene 1: Hallway - Meeting Marf
            {
                background: backgrounds.gate,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'Marf', expression: 'neutral', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'Carter',
                        text: 'Okay, I need to find room 2-B... This place is huge!'
                    },
                    {
                        character: 'Marf',
                        text: 'You look lost. First day?'
                    },
                    {
                        character: 'Carter',
                        text: 'Yeah, is it that obvious? I\'m looking for room 2-B.'
                    },
                    {
                        character: 'Marf',
                        text: 'That\'s my homeroom too. I\'m Marf. Follow me.'
                    },
                    {
                        character: 'Carter',
                        text: 'Thanks! I\'m Carter. Nice to meet you.'
                    }
                ],
                choices: [
                    {
                        text: 'Ask Marf about the school\'s special program',
                        effect: { Marf: 2 }
                    },
                    {
                        text: 'Stay quiet and just follow him',
                        effect: { Marf: 0 }
                    }
                ]
            },
            
            // Scene 2: Classroom - Meeting Lula
            {
                background: backgrounds.classroom,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'Lula', expression: 'happy', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'Marf',
                        text: 'Here we are. 2-B. See you around, Carter.'
                    },
                    {
                        character: 'Carter',
                        text: 'Thanks for the help, Marf.'
                    },
                    {
                        character: 'Lula',
                        text: 'Hi there! Are you the new student? I\'m Lula! Welcome to our class!'
                    },
                    {
                        character: 'Carter',
                        text: 'Wow, you\'re energetic. Yeah, I\'m Carter. Nice to meet you.'
                    },
                    {
                        character: 'Lula',
                        text: 'We don\'t get many transfers! You must be really special!'
                    }
                ],
                choices: [
                    {
                        text: 'What makes you think I\'m special?',
                        effect: { Lula: 2 }
                    },
                    {
                        text: 'I\'m just a regular transfer student',
                        effect: { Lula: -1 }
                    }
                ]
            },
            
            // Scene 3: Morning Classes
            {
                background: backgrounds.classroom,
                characters: [
                    { name: 'Carter', expression: 'surprised', position: 'center' }
                ],
                dialogue: [
                    {
                        character: 'Teacher',
                        text: 'Good morning class. Today we\'ll be practicing basic energy control exercises.'
                    },
                    {
                        character: 'Carter',
                        text: 'Energy control? What does that mean?'
                    },
                    {
                        character: 'Narrator',
                        text: 'You watch in amazement as students demonstrate various abilities - one creates small light orbs, another makes objects float.'
                    },
                    {
                        character: 'Carter',
                        text: 'This can\'t be real... are they actually using magic?'
                    }
                ]
            },
            
            // Scene 4: Cafeteria - Lunch with Lula
            {
                background: backgrounds.cafeteria,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'Lula', expression: 'happy', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'Lula',
                        text: 'Carter! Over here! The food here is amazing!'
                    },
                    {
                        character: 'Carter',
                        text: 'Hey Lula. This place is huge! So... about those abilities everyone seems to have...'
                    },
                    {
                        character: 'Lula',
                        text: 'Oh! You mean like how I can talk to animals? Yeah, everyone here has something special!'
                    }
                ],
                choices: [
                    {
                        text: 'That\'s incredible! Tell me more!',
                        effect: { Lula: 3 }
                    },
                    {
                        text: 'This has to be some kind of joke...',
                        effect: { Lula: -2 }
                    }
                ]
            },
            
            // Scene 5: Library - Meeting Jude
            {
                background: backgrounds.library,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'Jude', expression: 'neutral', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'Carter',
                        text: 'I need to understand what\'s going on here... These books are all about supernatural abilities.'
                    },
                    {
                        character: 'Jude',
                        text: 'First time in our library? The collection can be overwhelming.'
                    },
                    {
                        character: 'Carter',
                        text: 'Yeah, I just transferred here. I\'m Carter.'
                    },
                    {
                        character: 'Jude',
                        text: 'Jude. I manage the archives. If you have questions about our curriculum, I can help.'
                    }
                ],
                choices: [
                    {
                        text: 'Ask Jude to explain the school\'s purpose',
                        effect: { Jude: 3 }
                    },
                    {
                        text: 'Say you\'re just browsing',
                        effect: { Jude: 0 }
                    }
                ]
            },
            
            // Scene 6: Rooftop - Meeting JM
            {
                background: backgrounds.rooftop,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'JM', expression: 'neutral', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'Carter',
                        text: 'I needed some air... this is all too much to process.'
                    },
                    {
                        character: 'JM',
                        text: 'First day? The rooftop is my favorite escape spot too.'
                    },
                    {
                        character: 'Carter',
                        text: 'Yeah... I\'m Carter. This school is... different.'
                    },
                    {
                        character: 'JM',
                        text: 'JM. It takes time to adjust. When I first came here, I didn\'t believe it either.'
                    }
                ],
                choices: [
                    {
                        text: 'Ask JM how he adjusted',
                        effect: { JM: 3 }
                    },
                    {
                        text: 'Say you need to be alone',
                        effect: { JM: -1 }
                    }
                ]
            },
            
            // Scene 7: Afternoon Classes - Ability Assessment
            {
                background: backgrounds.classroom,
                characters: [
                    { name: 'Carter', expression: 'nervous', position: 'center' }
                ],
                dialogue: [
                    {
                        character: 'Teacher',
                        text: 'Carter, it\'s time for your ability assessment. Don\'t be nervous.'
                    },
                    {
                        character: 'Carter',
                        text: 'I really don\'t think I have any special abilities...'
                    },
                    {
                        character: 'Narrator',
                        text: 'The teacher places a crystal in front of you. As you touch it, it begins to glow with a soft pink light.'
                    },
                    {
                        character: 'Teacher',
                        text: 'Interesting... you have empathic abilities. You can sense and influence emotions.'
                    },
                    {
                        character: 'Carter',
                        text: 'Empathic? That would explain why I\'ve always been so sensitive to how people feel...'
                    }
                ]
            },
            
            // Scene 8: End of Day Decision
            {
                background: backgrounds.gate,
                characters: [
                    { name: 'Carter', expression: 'contemplative', position: 'center' }
                ],
                dialogue: [
                    {
                        character: 'Narrator',
                        text: 'The school day is over. You\'ve discovered you have empathic abilities and met several interesting people. Who would you like to walk home with?'
                    }
                ],
                choices: [
                    {
                        text: 'Walk with Marf',
                        nextScene: 9,
                        effect: { Marf: 3 }
                    },
                    {
                        text: 'Walk with Lula',
                        nextScene: 10,
                        effect: { Lula: 3 }
                    },
                    {
                        text: 'Walk with Jude',
                        nextScene: 11,
                        effect: { Jude: 3 }
                    },
                    {
                        text: 'Walk with JM',
                        nextScene: 12,
                        effect: { JM: 3 }
                    }
                ]
            },
            
            // Scene 9: Walking with Marf
            {
                background: backgrounds.gate,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'Marf', expression: 'neutral', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'Marf',
                        text: 'So, empathic abilities huh? That explains why you seemed so aware of everyone today.'
                    },
                    {
                        character: 'Carter',
                        text: 'Yeah, it\'s been overwhelming. Feeling everyone\'s emotions at once...'
                    },
                    {
                        character: 'Marf',
                        text: 'You\'ll learn to control it. If you need help, let me know.'
                    },
                    {
                        character: 'Narrator',
                        text: 'DAY 1 COMPLETE - Relationship with Marf improved!'
                    }
                ]
            },
            
            // Scene 10: Walking with Lula
            {
                background: backgrounds.gate,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'Lula', expression: 'happy', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'Lula',
                        text: 'An empath! That\'s so amazing! We should practice together!'
                    },
                    {
                        character: 'Carter',
                        text: 'I\'d like that. Your energy is really... calming.'
                    },
                    {
                        character: 'Lula',
                        text: 'Aww thanks! I can\'t wait to show you around more tomorrow!'
                    },
                    {
                        character: 'Narrator',
                        text: 'DAY 1 COMPLETE - Relationship with Lula improved!'
                    }
                ]
            },
            
            // Scene 11: Walking with Jude
            {
                background: backgrounds.gate,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'Jude', expression: 'neutral', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'Jude',
                        text: 'Empathic abilities are quite rare. The library has several texts that might help you understand your gift.'
                    },
                    {
                        character: 'Carter',
                        text: 'I\'d appreciate that. This is all so new to me.'
                    },
                    {
                        character: 'Jude',
                        text: 'You\'re handling it well. Come by the library tomorrow and I\'ll show you the relevant materials.'
                    },
                    {
                        character: 'Narrator',
                        text: 'DAY 1 COMPLETE - Relationship with Jude improved!'
                    }
                ]
            },
            
            // Scene 12: Walking with JM
            {
                background: backgrounds.gate,
                characters: [
                    { name: 'Carter', expression: 'neutral', position: 'left' },
                    { name: 'JM', expression: 'neutral', position: 'right' }
                ],
                dialogue: [
                    {
                        character: 'JM',
                        text: 'Empath, huh? That explains why you looked so overwhelmed today.'
                    },
                    {
                        character: 'Carter',
                        text: 'Yeah, feeling everyone\'s emotions at once is... intense.'
                    },
                    {
                        character: 'JM',
                        text: 'My sister is an empath too. If you need someone who understands, I\'m here.'
                    },
                    {
                        character: 'Narrator',
                        text: 'DAY 1 COMPLETE - Relationship with JM improved!'
                    }
                ]
            }
        ];

        // DOM elements
        const openingScreen = document.getElementById('opening-screen');
        const gameScreen = document.getElementById('game-screen');
        const playBtn = document.getElementById('play-btn');
        const backgroundEl = document.getElementById('background');
        const charactersEl = document.getElementById('characters');
        const characterNameEl = document.getElementById('character-name');
        const dialogueTextEl = document.getElementById('dialogue-text');
        const choicesEl = document.getElementById('choices');
        const nextBtn = document.getElementById('next-btn');
        const saveBtn = document.getElementById('save-btn');
        const loadBtn = document.getElementById('load-btn');
        const saveIndicatorEl = document.getElementById('save-indicator');
        const debugInfo = document.getElementById('debug-info');

        // Initialize game
        function initGame() {
            playBtn.addEventListener('click', startGame);
            nextBtn.addEventListener('click', nextDialogue);
            saveBtn.addEventListener('click', saveGame);
            loadBtn.addEventListener('click', loadGame);
            
            // Debug: Show current file paths
            updateDebugInfo();
        }

        function updateDebugInfo() {
            const currentScene = storyScript[gameState.currentScene];
            if (!currentScene) return;
            
            let debugText = `Scene: ${gameState.currentScene}<br>`;
            debugText += `Background: ${currentScene.background}<br>`;
            debugText += `Characters: ${currentScene.characters.map(c => c.name).join(', ')}`;
            debugInfo.innerHTML = debugText;
        }

        // Start the game
        function startGame() {
            openingScreen.style.display = 'none';
            gameScreen.style.display = 'flex';
            loadScene(0);
        }

        // Load a scene
        function loadScene(sceneIndex) {
            gameState.currentScene = sceneIndex;
            gameState.currentDialogue = 0;
            
            const scene = storyScript[sceneIndex];
            
            // Set background
            backgroundEl.style.backgroundImage = `url('${scene.background}')`;
            
            // Clear characters
            charactersEl.innerHTML = '';
            
            // Add characters
            scene.characters.forEach(char => {
                const charEl = document.createElement('img');
                charEl.className = `character character-${char.position}`;
                charEl.src = characterSprites[char.name][char.expression];
                charEl.alt = `${char.name} - ${char.expression}`;
                charEl.style.height = '80%';
                charEl.onerror = function() {
                    console.error(`Failed to load: ${this.src}`);
                    this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkNoYXJhY3RlcjwvdGV4dD48L3N2Zz4=';
                };
                charactersEl.appendChild(charEl);
            });
            
            // Display first dialogue
            displayDialogue();
            updateDebugInfo();
        }

        // Display current dialogue
        function displayDialogue() {
            const scene = storyScript[gameState.currentScene];
            const dialogue = scene.dialogue[gameState.currentDialogue];
            
            characterNameEl.textContent = dialogue.character;
            dialogueTextEl.textContent = dialogue.text;
            
            // Clear choices
            choicesEl.innerHTML = '';
            
            // Show choices if available at this dialogue point
            if (scene.choices && gameState.currentDialogue === scene.dialogue.length - 1) {
                scene.choices.forEach(choice => {
                    const choiceBtn = document.createElement('button');
                    choiceBtn.className = 'choice-btn';
                    choiceBtn.textContent = choice.text;
                    choiceBtn.addEventListener('click', () => makeChoice(choice));
                    choicesEl.appendChild(choiceBtn);
                });
                nextBtn.style.display = 'none';
            } else {
                nextBtn.style.display = 'flex';
            }
        }

        // Advance to next dialogue
        function nextDialogue() {
            const scene = storyScript[gameState.currentScene];
            
            if (gameState.currentDialogue < scene.dialogue.length - 1) {
                gameState.currentDialogue++;
                displayDialogue();
            } else if (!scene.choices) {
                // If no choices, move to next scene
                if (gameState.currentScene < storyScript.length - 1) {
                    loadScene(gameState.currentScene + 1);
                }
            }
            updateDebugInfo();
        }

        // Handle player choice
        function makeChoice(choice) {
            // Apply relationship effects
            if (choice.effect) {
                Object.keys(choice.effect).forEach(char => {
                    gameState.relationshipPoints[char] += choice.effect[char];
                });
            }
            
            // Handle next scene
            if (choice.nextScene) {
                loadScene(choice.nextScene);
            } else if (gameState.currentScene < storyScript.length - 1) {
                loadScene(gameState.currentScene + 1);
            }
            
            // Show next button again
            nextBtn.style.display = 'flex';
            updateDebugInfo();
        }

        // Save game state
        function saveGame() {
            gameState.savedGame = JSON.parse(JSON.stringify(gameState));
            saveIndicatorEl.style.display = 'block';
            setTimeout(() => {
                saveIndicatorEl.style.display = 'none';
            }, 2000);
        }

        // Load saved game
        function loadGame() {
            if (gameState.savedGame) {
                Object.assign(gameState, JSON.parse(JSON.stringify(gameState.savedGame)));
                loadScene(gameState.currentScene);
            } else {
                alert('No saved game found!');
            }
        }

        // Initialize the game when page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
